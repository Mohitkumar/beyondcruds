syntax = "proto3";

package log;

option go_package = "github.com/mohitkumar/mlog/api/log";

// LogService defines the RPCs for producing and fetching log records.
service LogService {
  //Produce appends a record to the log and returns the offset.
  rpc Produce(ProduceRequest) returns (ProduceResponse);
  //Fetch retrieves records from the log starting at a given offset.
  rpc Fetch(FetchRequest) returns (FetchResponse);
}

message ProduceRequest {
  string partition_id = 1;
  bytes payload = 2;
}

message ProduceResponse {
  int64 offset = 1;
}

message FetchRequest {
  string partition_id = 1;
  int64 offset = 2;
  int32 max_bytes = 3;
}

message FetchResponse {
  repeated Record records = 1;
}

message Record {
  uint64 offset = 1;
  bytes payload = 2;
}
